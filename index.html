<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Self Driving Car Game</title>
</head>

<link rel="stylesheet" type="text/css" href="style.css">
<script src="pixi.min.js"></script> <!-- importing pixi and custom classes -->
<script src="car.js"></script>
<script src="drive.js"></script>
  
<body>
  <script type="text/javascript">
    // The application will create a renderer using WebGL, if possible,
    // with a fallback to a canvas render. It will also setup the ticker
    // and the root stage PIXI.Container.
    var app = new PIXI.Application({backgroundColor : 0x1099bb});
    resize();

    window.onresize = function (event){ resize(); }
    window.onload = function () { onLoad(); };

    var drive = new Drive();

    function startButtonCallback()
	  {

      // Note that these parantheses on the edges are very important for some unknown reason
      var userCode = '(function() {console.log("User callback");})';
      var userCallback = eval(userCode);

      drive.startSimulation(userCallback);
    }

    function onLoad()
    {
      // The application will create a canvas element for you that you 
      // can then insert into the DOM.
      test = document.getElementById("htmlcanvas");
      test.appendChild(app.view);
    }

    function resize() {
      var w = window.innerWidth*(3.0/5.0);
      var h = w * (9.0/16.0);

      //this part resizes the canvas but keeps ratio the same
      app.renderer.view.style.width = w + "px";
      app.renderer.view.style.height = h + "px";

      //this part adjusts the ratio:
      app.renderer.resize(w,h);
    }

  </script>

  <div id="htmlcanvas" name="htmlcanvas" class="drawcanvas"></div>

  <button type="button" onclick="startButtonCallback()">Upload your code!</button>

</body>
</html>